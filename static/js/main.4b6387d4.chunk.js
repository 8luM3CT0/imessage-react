(this["webpackJsonpimessage-react"]=this["webpackJsonpimessage-react"]||[]).push([[0],{60:function(e,t,a){},64:function(e,t,a){},65:function(e,t,a){},66:function(e,t,a){},71:function(e,t,a){},72:function(e,t,a){},73:function(e,t,a){},74:function(e,t,a){},75:function(e,t,a){"use strict";a.r(t);var c=a(5),s=a(2),n=a.n(s),i=a(17),o=a.n(i),r=(a(60),a(11)),d=(a(64),a(22)),l=Object(d.b)({name:"user",initialState:{user:null},reducers:{login:function(e,t){e.user=t.payload},logout:function(e){e.user=null}}}),u=l.actions,j=u.login,b=u.logout,h=function(e){return e.user.user},m=l.reducer,O=a(20),p=a(87),f=a(47),v=a.n(f),x=(a(65),Object(d.b)({name:"chat",initialState:{chatId:null,chatName:null},reducers:{setChat:function(e,t){e.chatId=t.payload.chatId,e.chatName=t.payload.chatName}}})),g=x.actions.setChat,N=function(e){return e.chat.chatName},I=function(e){return e.chat.chatId},_=x.reducer,w=a(89),y=(a(66),Object(s.forwardRef)((function(e,t){e.id;var a=e.contents,s=a.timestamp,n=(a.displayName,a.email),i=a.message,o=a.photo,d=(a.uid,Object(r.c)(h));return Object(c.jsxs)("div",{ref:t,className:"message ".concat(d.email===n&&"message__sender"),children:[Object(c.jsx)(w.a,{className:"message__photo",src:o}),Object(c.jsx)("p",{children:i}),Object(c.jsx)("small",{children:new Date(null===s||void 0===s?void 0:s.toDate()).toLocaleString()})]})}))),S=a(24),C=S.a.initializeApp({apiKey:"AIzaSyATEGy2DXBchQl-HO30fS65rOkFkSps5Yw",authDomain:"imessage-app-2020.firebaseapp.com",databaseURL:"https://imessage-app-2020.firebaseio.com",projectId:"imessage-app-2020",storageBucket:"imessage-app-2020.appspot.com",messagingSenderId:"540333532175",appId:"1:540333532175:web:ae8b9da739ee5b13c8af7a",measurementId:"G-MBQ4JGNV7D"}).firestore(),k=S.a.auth(),J=new S.a.auth.GoogleAuthProvider,D=C,Y=a(46);var L=function(){var e=Object(r.c)(h),t=Object(s.useState)(""),a=Object(O.a)(t,2),n=a[0],i=a[1],o=Object(r.c)(N),d=Object(s.useState)([]),l=Object(O.a)(d,2),u=l[0],j=l[1],b=Object(r.c)(I);return Object(s.useEffect)((function(){b&&D.collection("chats").doc(b).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){return j(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}))})),Object(c.jsxs)("div",{className:"chat",children:[Object(c.jsxs)("div",{className:"chat__header",children:[Object(c.jsxs)("h4",{children:["To: ",Object(c.jsx)("span",{className:"chat__span",children:o})]}),Object(c.jsx)("strong",{children:"Details"})]}),Object(c.jsx)("div",{className:"chat__message",children:Object(c.jsx)(Y.a,{children:u.map((function(e){var t=e.id,a=e.data;return Object(c.jsx)(y,{contents:a},t)}))})}),Object(c.jsxs)("div",{className:"chat__input",children:[Object(c.jsxs)("form",{children:[Object(c.jsx)("input",{value:n,onChange:function(e){return i(e.target.value)},placeholder:"iMessage",type:"text"}),Object(c.jsx)("button",{onClick:function(t){t.preventDefault(),D.collection("chats").doc(b).collection("messages").add({timestamp:S.a.firestore.FieldValue.serverTimestamp(),message:n,uid:e.uid,photo:e.photo,email:e.email,displayName:e.displayName}),i("")},children:"Send Message"})]}),Object(c.jsx)(p.a,{children:Object(c.jsx)(v.a,{className:"mic__icon"})})]})]})},T=(a(71),a(72),a(48)),Z=a.n(T),M=a(49),B=a.n(M),G=(a(73),a(50));var W=function(e){var t,a,n,i,o=e.id,d=e.chatName,l=Object(r.b)(),u=Object(s.useState)([]),j=Object(O.a)(u,2),b=j[0],h=j[1];return Object(s.useEffect)((function(){D.collection("chats").doc(o).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){return h(e.docs.map((function(e){return e.data()})))}))}),[o]),Object(c.jsxs)("div",{onClick:function(){return l(g({chatId:o,chatName:d}))},className:"sidebarChat",children:[Object(c.jsx)(w.a,{src:null===(t=b[0])||void 0===t?void 0:t.photo,className:"sidebarChat__avatar"}),Object(c.jsxs)("div",{className:"sidebarChat__info",children:[Object(c.jsx)("h3",{children:d}),Object(c.jsx)("p",{children:null===(a=b[0])||void 0===a?void 0:a.message}),Object(c.jsx)("small",{children:G.a(new Date(null===(n=b[0])||void 0===n||null===(i=n.timestamp)||void 0===i?void 0:i.toDate()))})]})]})};var z=function(){var e=Object(r.c)(h),t=Object(s.useState)([]),a=Object(O.a)(t,2),n=a[0],i=a[1];return Object(s.useEffect)((function(){D.collection("chats").onSnapshot((function(e){return i(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}))}),[]),Object(c.jsxs)("div",{className:"sidebar",children:[Object(c.jsxs)("div",{className:"sidebar__header",children:[Object(c.jsx)(w.a,{onClick:function(){return k.signOut()},src:e.photo,className:"sidebar__avatar"}),Object(c.jsxs)("div",{className:"sidebar__input",children:[Object(c.jsx)(Z.a,{}),Object(c.jsx)("input",{placeholder:"Search"})]}),Object(c.jsx)(p.a,{variant:"outlined",className:"sidebar__inputButton",children:Object(c.jsx)(B.a,{onClick:function(){var e=prompt("Please enter a chat name");e&&D.collection("chats").add({chatName:e})}})})]}),Object(c.jsx)("div",{className:"sidebar__chats",children:n.map((function(e){var t=e.id,a=e.data.chatName;return Object(c.jsx)(W,{id:t,chatName:a},t)}))})]})};var A=function(){return Object(c.jsxs)("div",{className:"imessage",children:[Object(c.jsx)(z,{}),Object(c.jsx)(L,{})]})},E=a(88);a(74);var Q=function(){return Object(c.jsxs)("div",{className:"login",children:[Object(c.jsxs)("div",{className:"login__logo",children:[Object(c.jsx)("img",{src:"https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/a60c69b4-dbdc-49e3-b152-43bbdbfb0160/d6dy6qy-19e320f2-932f-4549-8050-2b7fb9289eda.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOiIsImlzcyI6InVybjphcHA6Iiwib2JqIjpbW3sicGF0aCI6IlwvZlwvYTYwYzY5YjQtZGJkYy00OWUzLWIxNTItNDNiYmRiZmIwMTYwXC9kNmR5NnF5LTE5ZTMyMGYyLTkzMmYtNDU0OS04MDUwLTJiN2ZiOTI4OWVkYS5wbmcifV1dLCJhdWQiOlsidXJuOnNlcnZpY2U6ZmlsZS5kb3dubG9hZCJdfQ.AQSIo8n9g9HHLZFVdCwqbDOjFg9DwZI35LCTIuLgtEw",alt:""}),Object(c.jsx)("h1",{children:"iMessage"})]}),Object(c.jsx)(E.a,{onClick:function(){k.signInWithPopup(J).catch((function(e){return alert(e.message)}))},children:"Sign In"})]})};var U=function(){var e=Object(r.c)(h),t=Object(r.b)();return Object(s.useEffect)((function(){k.onAuthStateChanged((function(e){t(e?j({uid:e.uid,photo:e.photoURL,email:e.email,displayName:e.displayName}):b())}))}),[]),Object(c.jsx)("div",{className:"app",children:e?Object(c.jsx)(A,{}):Object(c.jsx)(Q,{})})},V=Object(d.a)({reducer:{user:m,chat:_}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(Object(c.jsx)(n.a.StrictMode,{children:Object(c.jsx)(r.a,{store:V,children:Object(c.jsx)(U,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[75,1,2]]]);
//# sourceMappingURL=main.4b6387d4.chunk.js.map